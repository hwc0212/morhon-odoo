# 茂亨Odoo外贸专用版 - 自动化部署与管理脚本

## 📋 项目简介

茂亨Odoo外贸专用版自动化部署脚本是一个专为外贸企业设计的、高度集成的一键式开源ERP系统部署解决方案。本项目基于Odoo 17社区版，经过四年深度定制开发，专门解决了原生Odoo在国内外贸业务环境中的“水土不服”问题，重点优化了邮件集成、本地化财务流程、CRM管理及进销存等核心模块。

该脚本提供全自动化部署流程，可在10分钟内完成从零到完整生产环境的搭建，大幅降低企业数字化转型的技术门槛与时间成本。

## ✨ 核心特性

- **一键自动化部署**：全流程自动化安装与配置，无需手动干预复杂环境。
- **深度外贸业务流程定制**：预配置并默认启用CRM、进销存、财务、营销管理等外贸核心模块。
- **无缝兼容国内生态**：完美支持腾讯企业邮箱、阿里云邮箱等国内主流邮件服务商。
- **企业级精细化权限管理**：支持细粒度权限控制与多部门协作数据隔离。
- **深度邮件集成**：支持公司邮箱分配与在系统内直接收发、处理及跟踪客户邮件。
- **生产环境安全加固**：自动配置HTTPS、防火墙规则及系统安全策略。
- **智能资源优化**：根据服务器硬件配置，自动优化Odoo worker与PostgreSQL数据库参数。
- **完善的运维工具集**：内置备份、恢复、监控、日志查看等开箱即用的管理功能。

## 💻 系统要求与配置推荐

### **1. 最低配置（适用于测试或10人以下小团队）**
- **CPU**：2 核
- **内存**：4 GB RAM
- **存储**：40 GB SSD
- **带宽**：2 Mbps
- **操作系统**：Ubuntu 20.04/22.04 LTS

### **2. 推荐配置（适用于10-50人团队）**
- **CPU**：4 核
- **内存**：8 GB RAM
- **存储**：80 GB SSD（建议为数据库配置独立存储）
- **带宽**：5 Mbps 以上
- **操作系统**：Ubuntu 22.04 LTS

### **3. 高性能配置（适用于50-200人团队）**
- **CPU**：8 核
- **内存**：16 GB RAM
- **存储**：200 GB SSD（强烈建议数据库与文件存储分离）
- **带宽**：10 Mbps 以上
- **操作系统**：Ubuntu 22.04 LTS

### **用户规模与配置参考**
- **1-10用户**：最低配置
- **10-50用户**：推荐配置
- **50-200用户**：高性能配置
- **200+用户**：建议采用分布式部署架构，或联系我们的技术团队获取企业级定制方案。

## 🧩 默认启用模块

部署完成后，系统将默认启用以下经过深度定制和优化的核心业务模块：

1.  **CRM（客户关系管理）**
    *   客户与联系人全生命周期管理
    *   销售线索、商机管道与跟进过程跟踪
    *   客户活动、任务日程安排与提醒
    *   完整的客户交互历史记录

2.  **进销存管理**
    *   产品目录、属性与变体管理
    *   销售报价单、订单管理
    *   采购申请、订单与供应商协同
    *   多仓库库存管理、调拨与盘点
    *   发货单、物流跟踪管理

3.  **财务管理**
    *   符合中国会计准则的科目与账簿体系
    *   形式发票、商业发票全流程管理
    *   银行对账、收款与付款处理
    *   利润表、资产负债表等财务报表
    *   本地化税务处理支持

4.  **营销管理**
    *   邮件营销活动创建与批量发送
    *   客户细分与目标人群筛选
    *   营销活动效果追踪与分析
    *   潜在客户自动化培育流程

## 🚀 快速开始

### **第一步：环境准备**
1.  准备一台满足上述要求的VPS服务器。
2.  确保服务器拥有公网IP地址并可正常访问。
3.  （若选择域名模式）准备一个已备案的域名，并确保其DNS已正确解析到服务器IP。

### **第二步：下载部署脚本**
通过SSH客户端（如Terminal, PuTTY）连接到您的服务器，执行以下命令：
```bash
# 下载最新版部署脚本
wget https://raw.githubusercontent.com/morhon-tech/morhon-odoo/main/odoo-manager.sh
# 赋予脚本执行权限
chmod +x odoo-manager.sh
```

### **第三步：初始化服务器环境**
```bash
# 执行环境初始化，自动安装所有必要组件
sudo ./odoo-manager.sh init
```
初始化过程将自动完成：系统更新、Docker & Docker Compose安装、Nginx安装与优化、防火墙规则配置、中文字体安装等。

### **第四步：部署Odoo系统**
```bash
# 启动智能部署向导
sudo ./odoo-manager.sh deploy
```
部署向导将引导您完成：
1.  **选择部署模式**：
    *   `1) 域名模式`：绑定自有域名，并**自动申请并配置Let‘s Encrypt免费SSL证书（HTTPS）**。
    *   `2) 本地模式`：通过IP地址访问，适合内部测试。
2.  **输入配置信息**：根据提示输入域名、公司名称等。
3.  **确认并部署**：脚本显示配置摘要，确认后开始全自动部署。

### **第五步：系统初始化**
部署成功后，请务必记录脚本输出的：
*   系统访问URL
*   **初始管理员账户 (`admin`) 及随机密码**
*   数据库连接信息（如需）

**首次登录后，请立即：**
1.  修改管理员密码。
2.  在“设置”中配置公司基本信息。
3.  配置邮箱服务器（以启用邮件功能）。

## ⚙️ 部署后管理

### **系统监控**
```bash
# 查看综合运行状态
sudo ./odoo-manager.sh monitor
# 查看容器状态
sudo ./odoo-manager.sh status
```

### **数据备份与恢复**
```bash
# 创建完整备份（包含数据库和文件存储）
sudo ./odoo-manager.sh backup
# 列出所有备份
sudo ./odoo-manager.sh backup list
# 从指定备份恢复
sudo ./odoo-manager.sh restore [backup_file_name]
```

### **日志查看**
```bash
# 查看Odoo应用日志
sudo ./odoo-manager.sh logs odoo
# 实时跟踪日志
sudo ./odoo-manager.sh logs --follow odoo
```

### **系统维护**
```bash
# 重启所有服务
sudo ./odoo-manager.sh restart all
# 更新系统至最新版本
sudo ./odoo-manager.sh update
# 执行性能优化
sudo ./odoo-manager.sh optimize
```

## 📁 重要目录与配置

*   **实例目录**：`/opt/morhon-odoo/` - 存放所有应用配置、自定义模块及日志。
*   **数据卷**：
    *   数据库卷：`odoo-db-data`
    *   文件存储卷：`odoo-web-data`
*   **Docker镜像**：使用来自阿里云镜像仓库的稳定版本。
*   **网络与安全**：脚本会自动创建独立的Docker网络，并配置Nginx规则以增强安全性。

## 🤝 获取帮助与贡献

- **完整命令帮助**：`sudo ./odoo-manager.sh help`
- **GitHub仓库**：[https://github.com/morhon-tech/morhon-odoo](https://github.com/morhon-tech/morhon-odoo)
    *   提交问题 (Issue)
    *   查看源代码与贡献指南
- **社区与支持**：
    *   部署问题请优先在GitHub Issues中搜索或提交。
    *   需要专业的部署协助、数据迁移或定制开发服务，可通过项目主页获取联系信息。

---
**维护团队：安徽茂亨科技有限公司**  
*本项目基于 AGPL v3 许可证开源。*
